
PowerShell DSC 2.0 (Desired State Configuration 2.0)
DSC 2.0 is supported for use with [Azure Policy's machine configuration](https://learn.microsoft.com/en-us/azure/governance/machine-configuration/overview).
If you aren't using Azure Policy's machine configuration feature, you should use DSC 1.1.
With the release of PowerShell 7.2, the PSDesiredStateConfiguration module is no longer included in the PowerShell package.
```
Install-Module -Name PSDesiredStateConfiguration -Repository PSGallery -MaximumVersion 2.99
```
Start a process under a user
- https://learn.microsoft.com/en-us/powershell/dsc/reference/psdscresources/resources/windowsprocess/startunderuser


Write-Debug and Preferences

https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_Preference_Variables
- $DebugPreference=SilentlyContinue // affects Write-Debug
- Determines how PowerShell responds to debugging messages generated by a script, cmdlet or provider, or by a Write-Debug command
- values: SilentlyContinue, Stop, Continue, Inquire (https://learn.microsoft.com/en-us/dotnet/api/system.management.automation.actionpreference)
- You can use the Debug common parameter of a cmdlet (https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_commonparameters)
-
https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_scopes
- Get-Variable -Scope local, Get-Variable -Scope global
- global:, local:, private:, script:, using:, worflow:,
- current scope is always the Local scope
- private is not a scope, it's a option of visibility of an item outside of the scope
-
https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_profiles
- $PROFILE | Get-Member -Type NoteProperty, notepad $PROFILE
- function Pro {notepad $PROFILE.CurrentUserAllHosts}  // open your profile
- ```function Get-CmdletAlias ($cmdletname) {
   Get-Alias |
     Where-Object -FilterScript {$_.Definition -like "$cmdletname"} |
       Format-Table -Property Definition, Name -AutoSize
 }```
https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_variables
- $a = ..., [int]$i = 0, $k = 1, 2, 3
- Remove-Variable -Name a, Remove-Item -Path Variable:\a
- Set-Location Variable:, Get-ChildItem Variable:, Get-Help Variable
https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_automatic_variables
- $$, $?, ...

Variable Providers
https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_environment_provider
- Set-Location Env:, Get-ChildItem -Path Env:, Get-Item -Path Env:
- $env:
https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_variable_provider
- $variable:home
- ```Get-ChildItem -Path Variable: | Where-Object {
   $_.options -Match "Constant" `
   -or $_.options -Match "ReadOnly"
 } | Format-List -Property name, value, options```
https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_function_provider
- Get-Item -Path man | Format-Table -Wrap -Autosize
- New-Item -Path Function:Win32: -Value {Set-Location C:\Windows\System32} // "Win32:"
- Function:Win32: {Set-Location C:\Windows\System32} // "Win32:"
- $function:
https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_alias_provider
- Set-Location Alias:, PS Alias:\> Get-Item -Path *
- $Alias:ls


https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_prompts
- PS C:\> function prompt {"Hello, World > "}
  Hello, World >
- (Get-Item function:prompt).ScriptBlock

https://learn.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_signing
-